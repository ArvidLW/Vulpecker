--- gnutls_algorithms.c	15 Dec 2005 13:24:29 -0000	2.156
+++ gnutls_algorithms.c	11 Aug 2006 22:40:36 -0000	2.157
@@ -563,7 +563,7 @@ _gnutls_x509_oid2mac_algorithm (const ch
 {
   gnutls_mac_algorithm_t ret = 0;
 
-  GNUTLS_HASH_LOOP (if (strcmp (oid, p->oid) == 0)
+  GNUTLS_HASH_LOOP (if (p->oid && strcmp (oid, p->oid) == 0)
 		    {
 		    ret = p->id; break;}
   );