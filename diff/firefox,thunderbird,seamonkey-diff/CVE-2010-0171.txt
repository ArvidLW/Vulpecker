diff --git a/dom/base/nsDOMClassInfo.cpp b/dom/base/nsDOMClassInfo.cpp
--- a/dom/base/nsDOMClassInfo.cpp
+++ b/dom/base/nsDOMClassInfo.cpp
@@ -7410,25 +7410,28 @@ nsEventReceiverSH::AddEventListenerHelpe
                                           uintN argc, jsval *argv, jsval *rval)
 {
   if (argc < 3 || argc > 4) {
     ThrowJSException(cx, NS_ERROR_XPC_NOT_ENOUGH_ARGS);
 
     return JS_FALSE;
   }
 
-  OBJ_TO_INNER_OBJECT(cx, obj);
-
   nsresult rv = sXPConnect->GetJSObjectOfWrapper(cx, obj, &obj);
   if (NS_FAILED(rv)) {
     nsDOMClassInfo::ThrowJSException(cx, rv);
 
     return JS_FALSE;
   }
 
+  OBJ_TO_INNER_OBJECT(cx, obj);
+  if (!obj) {
+    return JS_FALSE;
+  }
+
   // Check that the caller has permission to call obj's addEventListener.
   if (NS_FAILED(sSecMan->CheckPropertyAccess(cx, obj,
                                              JS_GET_CLASS(cx, obj)->name,
                                              sAddEventListener_id,
                                              nsIXPCSecurityManager::ACCESS_GET_PROPERTY)) ||
       NS_FAILED(sSecMan->CheckPropertyAccess(cx, obj,
                                              JS_GET_CLASS(cx, obj)->name,
                                              sAddEventListener_id,