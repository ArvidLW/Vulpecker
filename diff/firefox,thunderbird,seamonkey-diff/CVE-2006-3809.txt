diff --git a/caps/src/nsScriptSecurityManager.cpp b/caps/src/nsScriptSecurityManager.cpp
index 8760781..fa56a28 100644
--- a/caps/src/nsScriptSecurityManager.cpp
+++ b/caps/src/nsScriptSecurityManager.cpp
@@ -910,6 +910,12 @@ nsScriptSecurityManager::CheckSameOrigin
     }
 
     /*
+    * Content can't ever touch chrome (we check for UniversalXPConnect later)
+    */
+    if (aObject == mSystemPrincipal)
+        return NS_ERROR_DOM_PROP_ACCESS_DENIED;
+
+    /*
     * If we failed the origin tests it still might be the case that we
     * are a signed script and have permissions to do this operation.
     * Check for that here.
diff --git a/content/base/src/nsContentUtils.cpp b/content/base/src/nsContentUtils.cpp
index ff1836d..c657d50 100644
--- a/content/base/src/nsContentUtils.cpp
+++ b/content/base/src/nsContentUtils.cpp
@@ -656,6 +656,14 @@ nsContentUtils::CanCallerAccess(nsIDOMNo
     return PR_TRUE;
   }
 
+  if (principal == systemPrincipal) {
+      // we already know subjectPrincipal isn't the systemPrincipal so if
+      // the object principal is they cannot match. Bail out now to
+      // avoid wasting time in CheckSameOriginPrincipal
+
+      return PR_FALSE;
+  }
+
   rv = sSecurityManager->CheckSameOriginPrincipal(subjectPrincipal,
                                                   principal);
   if (NS_SUCCEEDED(rv)) {
-- 
1.4.1

