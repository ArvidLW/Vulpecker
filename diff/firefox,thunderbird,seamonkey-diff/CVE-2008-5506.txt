--- content/base/src/nsXMLHttpRequest.cpp	19 Nov 2008 03:19:01 -0000	1.156.2.20
+++ content/base/src/nsXMLHttpRequest.cpp	26 Nov 2008 23:00:12 -0000
@@ -2047,18 +2047,18 @@ nsXMLHttpRequest::OnChannelRedirect(nsIC
 
     nsCOMPtr<nsIScriptSecurityManager> secMan =
              do_GetService(NS_SCRIPTSECURITYMANAGER_CONTRACTID, &rv);
     if (NS_FAILED(rv))
       return rv;
 
     rv = secMan->CheckSameOriginURI(oldURI, newURI);
     if (NS_FAILED(rv)) {
-      return rv;
       mDenyResponseDataAccess = PR_TRUE;
+      return rv;
     }
   }
 
   if (mChannelEventSink) {
     nsresult rv =
       mChannelEventSink->OnChannelRedirect(aOldChannel, aNewChannel, aFlags);
     if (NS_FAILED(rv)) {
       return rv;