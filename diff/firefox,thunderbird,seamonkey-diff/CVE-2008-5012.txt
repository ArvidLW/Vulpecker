--- modules/libpr0n/src/imgLoader.cpp	25 Nov 2008 22:33:41 -0000	1.96
+++ modules/libpr0n/src/imgLoader.cpp	26 Nov 2008 07:06:58 -0000
@@ -630,17 +630,17 @@ NS_IMETHODIMP imgLoader::LoadImageWithCh
 
     imgCache::Put(uri, request, getter_AddRefs(entry));
 
     // XXX(darin):  I'm not sure that using the original URI is correct here.
     // Perhaps we should use the same URI that indexes the cache?  Or, perhaps
     // the cache should use the original URI?  See bug 89419.
     nsCOMPtr<nsIURI> originalURI;
     channel->GetOriginalURI(getter_AddRefs(originalURI));
-    request->Init(originalURI, loadGroup, channel, entry, thread, aCX);
+    request->Init(originalURI, channel, channel, entry, thread, aCX);
 
     ProxyListener *pl = new ProxyListener(static_cast<nsIStreamListener *>(request));
     if (!pl) {
       NS_RELEASE(request);
       return NS_ERROR_OUT_OF_MEMORY;
     }
 
     NS_ADDREF(pl);
@@ -958,17 +958,17 @@ NS_IMETHODIMP imgCacheValidator::OnStart
 
   imgCache::Put(uri, request, getter_AddRefs(entry));
 
   // XXX(darin):  I'm not sure that using the original URI is correct here.
   // Perhaps we should use the same URI that indexes the cache?  Or, perhaps
   // the cache should use the original URI?  See bug 89419.
   nsCOMPtr<nsIURI> originalURI;
   channel->GetOriginalURI(getter_AddRefs(originalURI));
-  request->Init(originalURI, aRequest, channel, entry, NS_GetCurrentThread(), mContext);
+  request->Init(originalURI, channel, channel, entry, NS_GetCurrentThread(), mContext);
 
   ProxyListener *pl = new ProxyListener(static_cast<nsIStreamListener *>(request));
   if (!pl) {
     NS_RELEASE(request);
     return NS_ERROR_OUT_OF_MEMORY;
   }
 
   mDestListener = static_cast<nsIStreamListener*>(pl);
--- modules/libpr0n/src/imgRequest.cpp	25 Nov 2008 22:33:41 -0000	1.108
+++ modules/libpr0n/src/imgRequest.cpp	26 Nov 2008 07:07:02 -0000
@@ -987,17 +987,17 @@ imgRequest::OnChannelRedirect(nsIChannel
     rv = sink->OnChannelRedirect(oldChannel, newChannel, flags);
 
     if (NS_FAILED(rv))
       return rv;
   }
 
   RemoveFromCache();
 
-  mChannel = nsnull;
+  mChannel = newChannel;
 
   nsCOMPtr<nsIURI> uri;
   newChannel->GetURI(getter_AddRefs(uri));
 
   // If we don't still have a cache entry, we don't want to refresh the cache.
   if (uri && mCacheEntry)
     imgCache::Put(uri, this, getter_AddRefs(mCacheEntry));
 
