--- httpd/httpd/branches/2.2.x/modules/proxy/mod_proxy.c	2012/01/24 19:38:45	1235442
+++ httpd/httpd/branches/2.2.x/modules/proxy/mod_proxy.c	2012/01/24 19:39:31	1235443
@@ -566,6 +566,11 @@
         return OK;
     }
 
+    if ((r->unparsed_uri[0] == '*' && r->unparsed_uri[1] == '\0')
+        || !r->uri || r->uri[0] != '/') {
+        return DECLINED;
+    }
+
     /* XXX: since r->uri has been manipulated already we're not really
      * compliant with RFC1945 at this point.  But this probably isn't
      * an issue because this is a hybrid proxy/origin server.