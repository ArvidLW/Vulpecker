--- netwerk/protocol/res/src/nsResProtocolHandler.cpp	10 Nov 2006 23:49:07 -0000	1.68
+++ netwerk/protocol/res/src/nsResProtocolHandler.cpp	30 Jan 2007 14:36:34 -0000
@@ -326,17 +326,18 @@ nsResProtocolHandler::ResolveURI(nsIURI 
 
     rv = uri->GetPath(path);
     if (NS_FAILED(rv)) return rv;
 
     nsCAutoString filepath;
     url->GetFilePath(filepath);
 
     // Don't misinterpret the filepath as an absolute URI.
-    if (filepath.FindChar(':') != -1)
+    if (filepath.FindChar(':') != -1 ||
+        filepath.FindChar('\\') != -1)
         return NS_ERROR_MALFORMED_URI;
 
     const char *p = path.get() + 1; // path always starts with a slash
     NS_ASSERTION(*(p-1) == '/', "Path did not begin with a slash!");
 
     if (*p == '/')
         return NS_ERROR_MALFORMED_URI;
 
