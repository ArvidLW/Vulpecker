--- a/modules/plugin/base/src/nsJSNPRuntime.cpp	Mon Mar 30 21:06:35 2009 -0700
+++ b/modules/plugin/base/src/nsJSNPRuntime.cpp	Wed Apr 01 17:42:07 2009 -0700
@@ -1509,16 +1518,18 @@ NPObjWrapper_NewResolve(JSContext *cx, J
   NPObject *npobj = GetNPObject(cx, obj);
 
   if (!npobj || !npobj->_class || !npobj->_class->hasProperty ||
       !npobj->_class->hasMethod) {
     ThrowJSException(cx, "Bad NPObject as private data!");
 
     return JS_FALSE;
   }
+
+  PluginDestructionGuard pdg(LookupNPP(npobj));
 
   if (npobj->_class->hasProperty(npobj, (NPIdentifier)id)) {
     JSBool ok;
 
     if (JSVAL_IS_STRING(id)) {
       JSString *str = JSVAL_TO_STRING(id);
 
       ok = ::JS_DefineUCProperty(cx, obj, ::JS_GetStringChars(str),
