--- mozilla/js/src/jsobj.c
+++ mozilla/js/src/jsobj.c
@@ -1128,7 +1128,8 @@
         rt = cx->runtime;
         if (rt->findObjectPrincipals) {
             scopePrincipals = rt->findObjectPrincipals(cx, scopeobj);
-            if (!principals->subsume(principals, scopePrincipals)) {
+            if (scopePrincipals &&
+                !principals->subsume(principals, scopePrincipals)) {
                 JS_ReportErrorNumber(cx, js_GetErrorMessage, NULL,
                                      JSMSG_BAD_INDIRECT_CALL, js_eval_str);
                 return JS_FALSE;

--- mozilla/js/src/jsscript.c
+++ mozilla/js/src/jsscript.c
@@ -306,7 +306,8 @@
         rt = cx->runtime;
         if (rt->findObjectPrincipals) {
             scopePrincipals = rt->findObjectPrincipals(cx, scopeobj);
-            if (!principals->subsume(principals, scopePrincipals)) {
+            if (scopePrincipals &&
+                !principals->subsume(principals, scopePrincipals)) {
                 JS_ReportErrorNumber(cx, js_GetErrorMessage, NULL,
                                      JSMSG_BAD_INDIRECT_CALL,
                                      "Script.prototype.exec");
