diff --git a/dom/base/nsMimeTypeArray.h b/dom/base/nsMimeTypeArray.h
--- a/dom/base/nsMimeTypeArray.h
+++ b/dom/base/nsMimeTypeArray.h
@@ -97,16 +97,18 @@ class nsMimeType : public nsIDOMMimeType
 {
 public:
   nsMimeType(nsIDOMPlugin* aPlugin, nsIDOMMimeType* aMimeType);
   virtual ~nsMimeType();
 
   NS_DECL_ISUPPORTS
   NS_DECL_NSIDOMMIMETYPE
 
+  void DetachPlugin() { mPlugin = nsnull; }
+
 protected:
   nsIDOMPlugin* mPlugin;
   nsCOMPtr<nsIDOMMimeType> mMimeType;
 };
 
 class nsHelperMimeType : public nsIDOMMimeType
 {
 public:
diff --git a/dom/base/nsPluginArray.cpp b/dom/base/nsPluginArray.cpp
--- a/dom/base/nsPluginArray.cpp
+++ b/dom/base/nsPluginArray.cpp
@@ -280,18 +280,23 @@ nsPluginElement::nsPluginElement(nsIDOMP
   mMimeTypeArray = nsnull;
 }
 
 nsPluginElement::~nsPluginElement()
 {
   NS_IF_RELEASE(mPlugin);
 
   if (mMimeTypeArray != nsnull) {
-    for (PRUint32 i = 0; i < mMimeTypeCount; i++)
-      NS_IF_RELEASE(mMimeTypeArray[i]);
+    for (PRUint32 i = 0; i < mMimeTypeCount; i++) {
+      nsMimeType* mt = static_cast<nsMimeType*>(mMimeTypeArray[i]);
+      if (mt) {
+        mt->DetachPlugin();
+        NS_RELEASE(mt);
+      }
+    }
     delete[] mMimeTypeArray;
   }
 }
 
 
 // QueryInterface implementation for nsPluginElement
 NS_INTERFACE_MAP_BEGIN(nsPluginElement)
   NS_INTERFACE_MAP_ENTRY(nsISupports)