--- content/xul/content/src/nsXULElement.cpp	6 Aug 2007 15:27:20 -0000	1.726
+++ content/xul/content/src/nsXULElement.cpp	20 Aug 2007 16:04:05 -0000
@@ -2229,25 +2229,29 @@ nsresult nsXULElement::MakeHeavyweight()
 
 nsresult
 nsXULElement::HideWindowChrome(PRBool aShouldHide)
 {
     nsIDocument* doc = GetCurrentDoc();
     if (!doc || doc->GetRootContent() != this)
       return NS_ERROR_UNEXPECTED;
 
+    // only top level chrome documents can hide the window chrome
+    if (doc->GetParentDocument())
+      return NS_OK;
+
     nsIPresShell *shell = doc->GetPrimaryShell();
 
     if (shell) {
         nsIContent* content = static_cast<nsIContent*>(this);
         nsIFrame* frame = shell->GetPrimaryFrameFor(content);
 
         nsPresContext *presContext = shell->GetPresContext();
 
-        if (frame && presContext) {
+        if (frame && presContext && presContext->IsChrome()) {
             nsIView* view = frame->GetClosestView();
 
             if (view) {
                 nsIWidget* w = view->GetWidget();
                 NS_ENSURE_STATE(w);
                 w->HideWindowChrome(aShouldHide);
             }
         }
