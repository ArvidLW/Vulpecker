--- docshell/base/nsDocShell.cpp	15 Nov 2007 00:17:31 -0000	1.719.2.65
+++ docshell/base/nsDocShell.cpp	15 Nov 2007 00:38:19 -0000
@@ -3092,16 +3092,21 @@ nsDocShell::DisplayLoadError(nsresult aE
         case NS_ERROR_UNKNOWN_PROXY_HOST:
             // Proxy hostname could not be resolved.
             error.AssignLiteral("proxyResolveFailure");
             break;
         case NS_ERROR_PROXY_CONNECTION_REFUSED:
             // Proxy connection was refused.
             error.AssignLiteral("proxyConnectFailure");
             break;
+        case NS_ERROR_UNSAFE_CONTENT_TYPE:
+            // XXX: We can't add new strings on the branch, abuse
+            // malformedURI
+            error.AssignLiteral("malformedURI");
+            break;
         }
     }
 
     // Test if the error should be displayed
     if (error.IsEmpty()) {
         return NS_OK;
     }
 
--- docshell/base/nsWebShell.cpp	13 Sep 2007 18:23:50 -0000	1.656.2.7
+++ docshell/base/nsWebShell.cpp	15 Nov 2007 00:38:19 -0000
@@ -843,17 +843,18 @@ nsresult nsWebShell::EndPageLoad(nsIWebP
             (isTopFrame || mUseErrorPages)) {
       DisplayLoadError(aStatus, url, nsnull, channel);
     }
     // Errors to be shown for any frame
     else if (aStatus == NS_ERROR_NET_TIMEOUT ||
              aStatus == NS_ERROR_REDIRECT_LOOP ||
              aStatus == NS_ERROR_UNKNOWN_SOCKET_TYPE ||
              aStatus == NS_ERROR_NET_INTERRUPT ||
-             aStatus == NS_ERROR_NET_RESET) {
+             aStatus == NS_ERROR_NET_RESET ||
+             aStatus == NS_ERROR_UNSAFE_CONTENT_TYPE) {
       DisplayLoadError(aStatus, url, nsnull, channel);
     }
     else if (aStatus == NS_ERROR_DOCUMENT_NOT_CACHED) {
       /* A document that was requested to be fetched *only* from
        * the cache is not in cache. May be this is one of those 
        * postdata results. Throw a  dialog to the user,
        * saying that the page has expired from cache and ask if 
        * they wish to refetch the page from the net. Do this only
